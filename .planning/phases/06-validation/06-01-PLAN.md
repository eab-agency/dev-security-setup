---
phase: 06-validation
plan: 01
type: execute
---

<objective>
End-to-end verification that the entire Homebrew distribution pipeline works: brew install, CLI flags, version tracking, update alerting, and project configuration.

Purpose: Validate that all 5 prior phases integrate correctly before cutting the v3.0.0 release — catch issues before users hit them.
Output: Verified working install workflow, documented test results, project state updated to milestone complete.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Auto-selected based on dependency graph:
@.planning/phases/04-homebrew-tap/04-01-SUMMARY.md
@.planning/phases/05-documentation/05-01-SUMMARY.md

# Key files:
@setup-security.sh
@README.md
@.github/workflows/release.yml

**Tech stack available:** softprops/action-gh-release@v2, homebrew-formula-dsl
**Established patterns:** CLI flag convention (--long-form|-short), non-blocking network calls (curl with timeouts + || true), XDG-compatible cache directory, bin.install for shell script distribution
**Constraining decisions:**
- Phase 1: v3.0.0 major bump for Homebrew distribution break
- Phase 2: grep+sed over jq, 24h file-based cache, silent failure mode
- Phase 3: Manual formula SHA256 update (auto-bump deferred)
- Phase 4: Formula name `dev-security-setup`, binary `setup-security`, `license :cannot_represent`
- Phase 5: Single `brew install eab-agency/tools/dev-security-setup` command (auto-taps)

**Deferred issues (not addressed this phase):**
- Auto-bump formula on release — deferred until first release validates flow
- Add LICENSE file to source repo — deferred
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify CLI flags and script behavior locally</name>
  <files>setup-security.sh</files>
  <action>
Run the script directly to validate all CLI flags work correctly before testing via Homebrew:

1. `./setup-security.sh --version` — must output "setup-security version 3.0.0"
2. `./setup-security.sh --help` — must output usage text with all flags documented
3. `./setup-security.sh -v` — short flag for version
4. `./setup-security.sh -h` — short flag for help
5. Verify the check_for_updates function exists and is callable (grep for function definition)
6. Verify VERSION variable is set to "3.0.0"
7. Verify the script has executable permissions (`test -x setup-security.sh`)

Do NOT run setup-security.sh without flags (it would modify the current repo's git hooks). Only test informational flags (--version, --help, -v, -h).
  </action>
  <verify>All four flag invocations produce expected output. Script is executable. VERSION=3.0.0 confirmed.</verify>
  <done>--version outputs "setup-security version 3.0.0", --help outputs usage text, -v and -h work as aliases, script is executable</done>
</task>

<task type="auto">
  <name>Task 2: Verify release infrastructure readiness</name>
  <files>.github/workflows/release.yml, setup-security.sh</files>
  <action>
Validate that the release pipeline is correctly configured:

1. Verify `.github/workflows/release.yml` exists and has correct trigger (`on: push: tags: - "v*"`)
2. Verify it uses `softprops/action-gh-release@v2` with `generate_release_notes: true`
3. Verify `permissions: contents: write` is set
4. Verify the VERSION in setup-security.sh matches what would be tagged (3.0.0 → v3.0.0)
5. Verify the release process documentation in setup-security.sh comments is accurate (lines 6-12)
6. Check that the GitHub tarball URL pattern referenced in comments matches GitHub's actual pattern: `https://github.com/eab-agency/dev-security-setup/archive/refs/tags/vX.Y.Z.tar.gz`

Do NOT push tags or create releases — just verify the configuration is correct.
  </action>
  <verify>Workflow file exists with correct trigger, action, and permissions. VERSION matches tag pattern. Release docs in script are accurate.</verify>
  <done>Release workflow validated: correct trigger (v* tags), correct action (softprops/action-gh-release@v2), correct permissions, release process documented in script comments</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Verified all CLI flags work correctly and release infrastructure is properly configured. Now need to verify the Homebrew tap repository exists and the formula is correct.</what-built>
  <how-to-verify>
    1. Confirm the tap repo exists: `gh repo view eab-agency/homebrew-tools --json name 2>/dev/null` or visit https://github.com/eab-agency/homebrew-tools
    2. Confirm the formula file exists in the tap repo at `Formula/dev-security-setup.rb`
    3. Confirm `brew tap eab-agency/tools` succeeds (or is already tapped)
    4. If a v3.0.0 release exists: confirm `brew install eab-agency/tools/dev-security-setup` installs successfully and `setup-security --version` outputs "setup-security version 3.0.0"
    5. If NO release exists yet: confirm that's expected (release is cut after validation, formula has placeholder SHA256)

    Note: If the tap repo hasn't been created on GitHub yet, that's the expected state — Phase 4 created the formula file locally. Report what you find.
  </how-to-verify>
  <resume-signal>Report findings: "tap exists" or "tap not created yet" and whether a release has been cut. Type "approved" if everything checks out, or describe what's missing.</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `./setup-security.sh --version` outputs "setup-security version 3.0.0"
- [ ] `./setup-security.sh --help` outputs complete usage text
- [ ] `-v` and `-h` short flags work
- [ ] Release workflow is valid YAML with correct trigger and action
- [ ] Script is executable
- [ ] Human verified Homebrew tap state
</verification>

<success_criteria>

- All CLI flags verified working
- Release infrastructure validated
- Homebrew tap state confirmed by human
- No errors or regressions found
- Phase 6 complete — milestone done
</success_criteria>

<output>
After completion, create `.planning/phases/06-validation/06-01-SUMMARY.md`:

# Phase 6 Plan 01: Validation Summary

**[Substantive one-liner — e.g., "End-to-end validation passed: all CLI flags, release workflow, and Homebrew tap verified"]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- None (validation only)

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

Milestone complete. Ready to cut v3.0.0 release: `git tag v3.0.0 && git push origin main --tags`
</output>
